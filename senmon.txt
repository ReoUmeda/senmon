HTTP/2によるWebの変化
1.昨今のウェブの状況
最近のWebサイトではWebサーバとブラウザ間でやり取りをしなければならないデータの量が増えてきている。
そのためページ全体が表示されるのに遅くなってしまう。複数のコネクションを同時に使いデータを早く送る
方法が存在するがサーバやクライアントの付加を増やしてしまい余計に遅くさせてしまう可能性がある。また、
あるHTTPのリクエストに対する応答が遅くなっていると、後続の応答まで全てブロックされるというHTTP/1.1
の仕様もあり、コネクション数を増やしても効果が得られないことがある。
2. HTTPの歴史
　HTTPは1990年ごろCERNのティム・バーナーズ・リー氏がHTMLと共にCERN内の情報にアクセスするために設計
をした。HTTP/0.9はURLのみの簡単なやり取りだったがその後1996年にHTTP/1.0の仕様が公開されそれにはSMTP
のような各種ヘッダが追加され1999年に公開されたHTTP/1.1は複数のデータを効率よく転送するための持続的
接続やプロキシの利用等を想定した仕様になっていた。

3. HTTP/2の仕様
HTTP/2では実質的な転送速度を向上させることを目的としている。そのために通信路を仮想的に多重化して
素早いレスポンスを実現しつつ，データ圧縮で送信するデータを少なくしている。またHTTP/1.1との互換性を
維持しつつ求められる要求をSPDYを元に作られていてまずHTTP/1.1で通信をしてその後両方がHTTP/2に対応し
ているとHTTP/2による通信に移行する。
具体的に高速化はコマンドやパラメーターの送信データを「フレーム」というバイナリ形式で送信するように
なりフレームでHTTP/2はやり取りをするようになっている。そのようにすると小さな容量で転送ができ
テキストプロトコルとは違い空白の処理などがなく決まりきった形になっているため解析がしやすくなっている。
また「ストリーム」という仮想的な通信路を作りそれを使い双方向に「フレーム」を送受信する。
1つのコネクションで複数のストリームを作るとHTTP/1.1での複数のコネクションを使ったのと同等以上やり取り
が出来，ルーターやファイアウォール、プロキシサーバなどのネットワーク全体に対する負担が少なくなる。
そのためHTTP/1.1とは違いクライアントとサーバ間のコネクションは1つだけにしたほうが良いようになっている。
HTTP/1.1でも「パイプライン」機能を使えば、1つのコネクションで複数のリクエストを連続して送信することが
可能だったが、その場合は、レスポンスは送信したリクエスト順になる。だがHTTP/2のストリームではレスポンス
の順番を変更できるので、例えばサーバ側の処理が重い場合は、それ以外の軽い処理のレスポンスを先に返す、
といったことが可能になる。
ストリームには「優先度」を指定することもでき、後から緊急度の高いリクエストを送って、その結果を先に返す
ように要求することもできる優先度制御がある。
　HTTP/2では通信の状態を制御する機能として、「フロー制御」 機能も用意されている。一度に送信可能な
データ量を抑制して受信側のバッファーがあふれてリソース不足になるのを防いだり、逆に大きなウィンドウサイズ
を 指定して、巨大なデータを効率よく送信させたりできる。HTTP/1.1ではTCP/IPのプロトコルスタックに含まれる
ウィンドウ制御に依存していたが、HTTP/2ではWebサーバやアプリケーションがある程度制御できるようになる。
　HTTP/2では、より信頼性の高いエラー処理ができるようになっている。 HTTP/1.1ではエラーが発生した場合、
サーバがそのリクエストを受け付けて処理したのか、それとも単にリクエストが届いていないのか、
などを区別する方法がなかった。処理内容によっては、リクエストを再送して再実行すると不具合を起こすものもあり、
注意してシステムを設計する必要がある。HTTP/2では、ストリームを使うことにより、どのストリーム番号の処理まで
完了したかをクライアント側から確実に確認できるようになっており、より信頼性の高いシステムを構築できる。
　HTTPのリクエストとレスポンスには、「HTTPヘッダー」と呼ばれるテキストデータが含まれている。
この部分は長さがある割には決まった文字列も多く、また連続する複数のHTTPヘッダーを観測して比較すると、
その差が少ないことが多い。そこで、このHTTPヘッダー部分を圧縮できれば通信データの削減につながり、
もし1ページが約80個のアセットで構成されており、各リクエストが1400byteのヘッダーを持つと仮定すると
ヘッダーの送出だけで7-8ラウンドトリップが必要となってしまうため圧縮することによりパケットの数を減らすこと
になりラウンドトリップが減るためパフォーマンスの向上が期待できる。HTTP/2では「HPACK」という方法が採用されている。
サーバプッシュによるデータ送信によってWebサーバ側からWebブラウザに対して、あらかじめ必要となるデータを送信
しておく機能でありブラウザにページを表示をするために必要な画像などを送ることによりラウンドトリップを減らす
ことが出来る。

4.HTTP/2今後
HTTP/2を使うためにはサーバ側とブラウザ側の両方が対応していく必要があるが主要ブラウザの最新バージョンは
HTTP/2に対応しており「Windows10」の「Internet Explorer 11」、「Firefox 36」、「Chrome 40」などがある。
HTTP/2はまだIETFに承認されてRFCとして文章化されている最中でありHTTP/1.1に最適化されていると単にHTTP/2に
変えるだけではページの表示は遅くなる可能性もありまだHTTP/2の恩恵を受けるためには時間がかかる。




http://www.atmarkit.co.jp/ait/articles/1409/18/news135.html
http://japan.zdnet.com/article/35061196/
http://http2.info/faq.html#why-revise-http
http://ja.wikipedia.org/wiki/Hypertext_Transfer_Protocol
http://ja.wikipedia.org/wiki/%E3%83%86%E3%82%A3%E3%83%A0%E3%83%BB%E3%83%90%E3%83%BC%E3%83%8A%E3%83%BC%E3%82%BA%EF%BC%9D%E3%83%AA%E3%83%BC#cite_note-proposal-4
http://ja.wikipedia.org/wiki/Hypertext_Transfer_Protocol


関連単語
Head of Line Blocking
先頭でパケットがブロックされてしまうと次のリクエストができない

リクエスト
操作や処理、メッセージなどのこと

全二重多重化通信
１つの回線で二つの信号を送り通信をする。
http://www.wdic.org/w/WDIC/%E5%8D%8A%E4%BA%8C%E9%87%8D

Hypertext Transfer Protocol
WebブラウザとWebサーバの間でHTMLなどのコンテンツの送受信に用いられる通信プロトコル
http://ja.wikipedia.org/wiki/Hypertext_Transfer_Protocol

World Wide Web
WWWとは、世界中のサーバで公開されている情報をインターネットのWebページとして閲覧することができる仕組みのこと
http://www.ocn.ne.jp/support/words/wxyz/WWW.html

輻輳制御
電気通信においてトラフィックを制御し、例えばパケットの転送レートを削減するなどして中間ノードや
ネットワークの許容量（処理能力やリンク数）を超過することによる輻輳さらには輻輳崩壊を防ぐことである。
http://ja.wikipedia.org/wiki/%E8%BC%BB%E8%BC%B3%E5%88%B6%E5%BE%A1

輻輳
利用者のアクセスが特定の宛先に集中することにより、通常行えるはずの通話・通信ができなくなる状況を指す

輻輳崩壊
インターネットでアクセスするとき接続できないと再接続しようとしさらに輻輳が悪くなってしまうこと
http://e-words.jp/w/%E8%BC%BB%E8%BC%B3.html

プロトコル
通信におけるプロトコルとは、複数の主体が滞りなく信号やデータ、情報を相互に伝送できるよう、あらかじめ決められた約束事や手順の集合のこと。
http://e-words.jp/w/%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB.html

Webブラウザ
Webページを閲覧するためのアプリケーションソフト。インターネットからHTMLファイルや画像ファイル、音楽ファイルなど
をダウンロードし、レイアウトを解析して表示・再生する。
http://e-words.jp/w/Web%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6.html

パケット
データ通信ネットワークを流れるデータの単位で、伝送されるデータ本体に送信先の所在データなど制御情報を付加した小さなまとまりのこと。

http://e-words.jp/w/%E3%83%91%E3%82%B1%E3%83%83%E3%83%88.html

HTML
文章の論理構造や表示の仕方などを記述することができる。
http://e-words.jp/w/HTML.html

SPDY
WebサーバとWebブラウザがデータを送受信するための通信プロトコルの一つであるHTTPを改良したプロトコル。
http://e-words.jp/w/SPDY.html

バイナリ
コンピュータが扱えるよう2進法に則って0と1の羅列(ビット列)として表現されたデータやそのような表現形式をバイナリという。
また、そのようなデータのうち、テキスト(文字)形式ではない任意のデータ形式のこと。
http://e-words.jp/w/%E3%83%90%E3%82%A4%E3%83%8A%E3%83%AA.html

ラウンドトリップ
通信やネットワーク、データ伝送などの分野では、通信相手に信号やデータを発信して、応答が帰ってくるまでの過程をラウンドトリップという
http://e-words.jp/w/%E3%83%A9%E3%82%A6%E3%83%B3%E3%83%89%E3%83%88%E3%83%AA%E3%83%83%E3%83%97.html

アセット
ゲームやデジタルコンテンツの開発では、その構成要素となる画像や3Dモデル、音楽、効果音などの素材のことをアセットということがある。
http://e-words.jp/w/%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88.html

レスポンス
ネットワーク通信で、通信相手にデータを送信した後、相手から送られてくる返信やその内容のことをレスポンスという。
http://e-words.jp/w/%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B9.html

RFC
インターネットに関する技術の標準を定める団体であるIETFが正式に発行する文書。
http://e-words.jp/w/RFC.html

IETF
インターネットで利用される技術の標準化を推進する組織の一つ
通信プロトコルやデータ形式など、インターネットで情報を交換するのに必要な技術標準の策定を行っている
http://e-words.jp/w/IETF.html

ハイパーテキスト
コンピュータを利用した文書システムの一つ。文書の任意の場所に、他の文書の位置情報(ハイパーリンク)を埋めこみ、複数の文書を相互に連結できる仕組みのこと。
http://e-words.jp/w/%E3%83%8F%E3%82%A4%E3%83%91%E3%83%BC%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88.html

ハイパーリンク
文書内に埋め込まれた、他の文書や画像などの位置情報。
http://e-words.jp/w/%E3%83%8F%E3%82%A4%E3%83%91%E3%83%BC%E3%83%AA%E3%83%B3%E3%82%AF.html

プロキシ
企業などの内部ネットワークとインターネットの境界にあり、直接インターネットに接続できない
内部のコンピュータに代わって、「代理」としてインターネットとの接続を行うコンピュータのこと。また、そのための機能を実現するソフトウェア。
http://e-words.jp/w/%E3%83%97%E3%83%AD%E3%82%AD%E3%82%B7.html

ルータ
ネットワーク上を流れるデータを他のネットワークに中継する機器
http://e-words.jp/w/%E3%83%AB%E3%83%BC%E3%82%BF.html








